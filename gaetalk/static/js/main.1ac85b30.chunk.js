(this.webpackJsonpgaetalk=this.webpackJsonpgaetalk||[]).push([[0],{25:function(e,t,c){},28:function(e,t,c){},30:function(e,t,c){"use strict";c.r(t);var n=c(3),r=c.n(n),s=c(17),a=c.n(s),i=(c(25),c(14)),o=c(15),u=c(9),d=c(18),l=c(19),j=c.n(l),f=c(12);c(31),c(32);f.a.initializeApp({apiKey:"AIzaSyC17JfGlIYgic4alZQwJQ3w0d0DWEYNscY",authDomain:"gaetalk-dc0e6.firebaseapp.com",projectId:"gaetalk-dc0e6",storageBucket:"gaetalk-dc0e6.appspot.com",messagingSenderId:"578915040528",appId:"1:578915040528:web:4e59a1fbf88e33bca7f995",measurementId:"G-G6LGJ232XX"}),f.a.analytics();var b=f.a,h=(c(28),c(2)),O=b.firestore(),m=function(e){var t=e.rooms,c=(e.setRooms,e.selectedRoom),n=e.setSelectedRoom,r=t.map((function(e){return Object(h.jsx)("div",{children:Object(h.jsx)("button",{className:e===c?"selected-room":void 0,onClick:function(){n(e)},children:e.id})},e.id)}));return Object(h.jsxs)("div",{id:"rooms",children:[Object(h.jsx)("h3",{children:"\ub300\ud654\ubc29"}),Object(h.jsx)("div",{children:r})]})},v=function(e){return e.charCodeAt(0)},g=function(e,t,c){var n=v(e);return v(t)<=n&&n<=v(c)},p=function(e){if(!e)throw"\uc720\uc800 Id\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.";if(e.length>16)throw"\uc720\uc800 Id\uac00 \ub108\ubb34 \uae41\ub2c8\ub2e4. 16\uc790 \uc774\ud558\ub85c \ud574\uc8fc\uc138\uc694.";var t=function(e){return g(e,"0","9")||g(e,"A","Z")||g(e,"a","z")||g(e,"\uac00","\ud7af")||g(e,"\u1100","\u11ff")||g(e,"\ua960","\ua97c")||g(e,"\ud7b0","\ud7c6")||g(e,"\ud7cb","\ud7fb")||g(e,"\u3131","\u3163")||g(e,"\u3165","\u318e")||g(e,"\u3041","\u309f")||g(e,"\u30a0","\u30ff")||g(e,"\u4e00","\u9fff")||g(e,"\u3400","\u4dbf")||"."===e||"-"===e||"_"===e};if(!function(e){var c,n=Object(d.a)(e);try{for(n.s();!(c=n.n()).done;){var r=c.value;if(!t(r))return!1}}catch(s){n.e(s)}finally{n.f()}return!0}(e))throw"\uc720\uc800 Id\uc5d0 \ud5c8\uc6a9\ub418\uc9c0 \uc54a\ub294 \ubb38\uc790\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.";if(e.toLowerCase().includes("gaejotbab")||e.includes("\uac1c\uc886\ubc25"))throw"\uc0ac\uc6a9\uc774 \ubd88\uac00\ub2a5\ud55c \uc720\uc800 Id\uc785\ub2c8\ub2e4."},x=function(e){var t=e.selectedRoom,c=Object(n.useState)([]),r=Object(u.a)(c,2),s=r[0],a=r[1],d=Object(n.useState)(""),l=Object(u.a)(d,2),f=l[0],m=l[1],v=Object(n.useState)(""),g=Object(u.a)(v,2),x=g[0],y=g[1],I=Object(n.useRef)([]),k=Object(n.useRef)(0),S=Object(n.useState)(0),w=Object(u.a)(S,2),R=w[0],C=w[1],A=Object(n.useRef)(null),E=Object(n.useRef)(null),T=Object(n.useRef)(null),L="rooms/".concat(t.id,"/events"),Y=Object(n.useState)(!0),D=Object(u.a)(Y,2),H=D[0],F=D[1];Object(n.useEffect)((function(){try{var e=localStorage.getItem("userId");if(null===e)return;m(e)}catch(t){}}),[]),Object(n.useEffect)((function(){var e=O.collection(L).orderBy("createdAt").limitToLast(100).onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"===e.type&&e.doc.data().createdAt||"modified"===e.type){var t=Object(o.a)(Object(o.a)({},e.doc.data()),{},{id:e.doc.id});I.current.push(t),++k.current,C(k.current)}}))}));return function(){e(),a([])}}),[t,L]),Object(n.useEffect)((function(){0!==I.current.length&&(a([].concat(Object(i.a)(s),Object(i.a)(I.current))),I.current=[])}),[R,s]);var J=s.map((function(e){var t,c=null;if(H){var n=j()(e.createdAt.toDate()).format("YYYY-MM-DD HH:mm:ss");c=Object(h.jsxs)("span",{children:["[",n,"]"]})}switch(e.type){case"userEntered":t=Object(h.jsxs)("p",{children:[c," ",Object(h.jsx)("strong",{children:e.userId})," \ub2d8\uc774 \uc785\uc7a5\ud558\uc168\uc2b5\ub2c8\ub2e4."]},e.id);break;case"message":for(var r=[],s=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/i,a=e.messageText;;){var i=a.match(s);if(!i){r.push(Object(h.jsx)("span",{children:a}));break}var o=i[0],u=i.index;r.push(Object(h.jsx)("span",{children:a.substring(0,u)})),r.push(Object(h.jsx)("a",{href:o,target:"_blank",rel:"noreferrer",children:o})),a=a.substring(u+o.length)}t=Object(h.jsxs)("p",{children:[c," ",Object(h.jsx)("strong",{children:e.userId}),": ",r]},e.id)}return t})),N=Object(n.useRef)(!1),B=Object(n.useState)(!0),G=Object(u.a)(B,2),Z=G[0],_=G[1];Object(n.useLayoutEffect)((function(){var e=A.current;null!=e&&Z&&(e.scrollTop=e.scrollHeight-e.clientHeight)}));var z=!1;try{p(f),z=!0}catch(M){}return Object(h.jsxs)("div",{id:"messages",children:[Object(h.jsxs)("div",{id:"messages-header",children:[Object(h.jsxs)("h3",{children:["\ub300\ud654 (",t.id,")"]}),Object(h.jsx)("div",{id:"messages-control-panel",children:Object(h.jsxs)("label",{children:[Object(h.jsx)("input",{type:"checkbox",name:"showCreatedAt",checked:H,onChange:function(e){null!=e.target&&F(e.target.checked)},style:{verticalAlign:"baseline"}}),"\uc2dc\uac04 \ubcf4\uae30"]})})]}),Object(h.jsx)("div",{id:"events",ref:A,onScroll:function(e){var t=A.current;null!=t&&_(t.scrollHeight-t.clientHeight-5<=t.scrollTop)},children:J}),Object(h.jsxs)("div",{className:"send-window",children:[Object(h.jsx)("input",{id:"user-id",className:!f||z?void 0:"user-id-invalid",type:"text",name:"userId",value:f,onChange:function(e){var t=e.target.value;m(t);try{localStorage.setItem("userId",t)}catch(M){}},placeholder:"\uc720\uc800 Id",maxLength:16,autoComplete:"off"}),Object(h.jsx)("input",{ref:E,id:"message-text",className:"message-text",type:"text",name:"messageText",value:x,onChange:function(e){y(e.target.value)},onKeyUp:function(e){var t;"Enter"===e.key&&(null===(t=T.current)||void 0===t||t.click())},placeholder:"\uba54\uc2dc\uc9c0",maxLength:1024,autoComplete:"off"}),Object(h.jsx)("button",{ref:T,id:"send-message-button",onClick:function(){if(!N.current){N.current=!0;try{p(f)}catch(M){return alert(M),void(N.current=!1)}if(x)if(x.trim()){if(x.length>1024)return window.alert("\uba54\uc2dc\uc9c0\uac00 \ub108\ubb34 \uae41\ub2c8\ub2e4."),void(N.current=!1);var e;try{e={userId:f,type:"message",messageType:"text",messageText:x,createdAt:b.firestore.FieldValue.serverTimestamp()}}catch(M){return void(N.current=!1)}O.collection(L).doc().set(e).then((function(e){var t;null===(t=E.current)||void 0===t||t.focus(),y(""),N.current=!1})).catch((function(e){N.current=!1}))}else N.current=!1;else N.current=!1}},children:"\ubcf4\ub0b4\uae30"})]})]})},y=function(e){var t=e.selectedRoom;return t?Object(h.jsx)(x,{selectedRoom:t}):Object(h.jsx)("div",{id:"messages-with-no-selected-room",children:Object(h.jsx)("div",{children:"\ubc29\uc744 \uc120\ud0dd\ud558\uc138\uc694."})})};var I=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),c=t[0],r=t[1],s=Object(n.useState)(null),a=Object(u.a)(s,2),i=a[0],o=a[1];return Object(n.useEffect)((function(){O.collection("rooms").get().then((function(e){var t=[];e.forEach((function(e){var c={id:e.id};t.push(c)})),r(t)}))}),[]),Object(h.jsxs)("div",{id:"app",children:[Object(h.jsx)("div",{id:"header",children:Object(h.jsx)("h2",{children:"\uac1c\ud1a1"})}),Object(h.jsx)(m,{rooms:c,setRooms:r,selectedRoom:i,setSelectedRoom:o}),Object(h.jsx)(y,{selectedRoom:i})]})},k=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,33)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;c(e),n(e),r(e),s(e),a(e)}))};a.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(I,{})}),document.getElementById("root")),k()}},[[30,1,2]]]);