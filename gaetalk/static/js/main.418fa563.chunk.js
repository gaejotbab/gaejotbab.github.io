(this.webpackJsonpgaetalk=this.webpackJsonpgaetalk||[]).push([[0],{24:function(e,t,c){},26:function(e,t,c){},28:function(e,t,c){"use strict";c.r(t);var n=c(3),s=c.n(n),a=c(17),o=c.n(a),r=(c(24),c(18)),i=c(14),d=c(15),l=c(9),u=c(12);c(29),c(30);u.a.initializeApp({apiKey:"AIzaSyC17JfGlIYgic4alZQwJQ3w0d0DWEYNscY",authDomain:"gaetalk-dc0e6.firebaseapp.com",projectId:"gaetalk-dc0e6",storageBucket:"gaetalk-dc0e6.appspot.com",messagingSenderId:"578915040528",appId:"1:578915040528:web:e1a25643f31ef150a7f995",measurementId:"G-F341D86F1Y"}),u.a.analytics();var j=u.a,f=(c(26),c(2)),b=j.firestore(),h=function(e){var t=e.rooms,c=(e.setRooms,e.selectedRoom),n=e.setSelectedRoom,s=t.map((function(e){return Object(f.jsx)("div",{children:Object(f.jsx)("button",{className:e===c?"selected-room":void 0,onClick:function(){n(e)},children:e.id})},e.id)}));return Object(f.jsxs)("div",{id:"rooms",children:[Object(f.jsx)("h2",{children:"\ub300\ud654\ubc29"}),Object(f.jsx)("div",{children:s})]})},O=function(e){var t=e.selectedRoom,c=Object(n.useState)([]),s=Object(l.a)(c,2),a=s[0],o=s[1],u=Object(n.useState)(""),j=Object(l.a)(u,2),h=j[0],O=j[1],m=Object(n.useState)(""),g=Object(l.a)(m,2),v=g[0],p=g[1],x=Object(n.useRef)([]),w=Object(n.useRef)(0),I=Object(n.useState)(0),y=Object(l.a)(I,2),S=y[0],k=y[1],C=Object(n.useRef)(null),R=Object(n.useRef)(null),E="rooms/".concat(t.id,"/events");Object(n.useEffect)((function(){return b.collection(E).orderBy("createdAt").onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"===e.type){var t=Object(d.a)(Object(d.a)({},e.doc.data()),{},{id:e.doc.id});x.current.push(t),++w.current,k(w.current),console.log(t)}}))}))}),[t,E]),Object(n.useEffect)((function(){0!==x.current.length&&(o([].concat(Object(i.a)(a),Object(i.a)(x.current))),x.current=[])}),[S,a]);var T=a.map((function(e){var t;switch(e.type){case"userEntered":t=Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:e.userId})," \ub2d8\uc774 \uc785\uc7a5\ud558\uc168\uc2b5\ub2c8\ub2e4."]},e.id);break;case"message":t=Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:e.userId}),": ",e.messageText]},e.id)}return t})),A=Object(n.useState)(!0),D=Object(l.a)(A,2),F=D[0],B=D[1];Object(n.useLayoutEffect)((function(){var e=C.current;null!=e&&F&&(e.scrollTop=e.scrollHeight-e.clientHeight)}));return Object(f.jsxs)("div",{id:"messages",children:[Object(f.jsxs)("h2",{children:["\ub300\ud654 (",t.id,")"]}),Object(f.jsx)("div",{id:"events",ref:C,onScroll:function(e){var t=C.current;null!=t&&B(t.scrollHeight-t.clientHeight-5<=t.scrollTop)},children:T}),Object(f.jsxs)("div",{className:"send-window",children:[Object(f.jsx)("input",{className:"user-id",type:"text",name:"userId",value:h,onChange:function(e){O(e.target.value)},placeholder:"\uc720\uc800 Id",maxLength:16,autoComplete:"off"}),Object(f.jsx)("input",{ref:R,id:"message-text",className:"message-text",type:"text",name:"messageText",value:v,onChange:function(e){p(e.target.value)},onKeyUp:function(e){var t;13===e.keyCode&&(e.preventDefault(),null===(t=document.getElementById("send-message-button"))||void 0===t||t.click())},placeholder:"\uba54\uc2dc\uc9c0",maxLength:1024,autoComplete:"off"}),Object(f.jsx)("button",{id:"send-message-button",onClick:function(){if(h)if(h.length>16)window.alert("\uc720\uc800 Id\uac00 \ub108\ubb34 \uae41\ub2c8\ub2e4. 16\uc790 \uc774\ud558\ub85c \ud574\uc8fc\uc138\uc694.");else{var e=function(e){return e.charCodeAt(0)},t=function(t,c,n){var s=e(t);return e(c)<=s&&s<=e(n)},c=function(e){return t(e,"0","9")||t(e,"A","Z")||t(e,"a","z")||t(e,"\uac00","\ud7af")||t(e,"\u1100","\u11ff")||t(e,"\ua960","\ua97c")||t(e,"\ud7b0","\ud7c6")||t(e,"\ud7cb","\ud7fb")||t(e,"\u3131","\u3163")||t(e,"\u3165","\u318e")||"."===e||"-"===e||"_"===e};if(function(e){var t,n=Object(r.a)(e);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(!c(s))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}(h)){if(h.includes("gaejotbab")||h.includes("\uac1c\uc886\ubc25"))window.alert("\uc0ac\uc6a9\uc774 \ubd88\uac00\ub2a5\ud55c \uc720\uc800 Id\uc785\ub2c8\ub2e4.");else if(v){var n={userId:h,type:"message",messageType:"text",messageText:v,createdAt:new Date};b.collection(E).doc().set(n).then((function(e){var t;null===(t=R.current)||void 0===t||t.focus(),p("")}))}}else window.alert("\uc720\uc800 Id\uc5d0 \ud5c8\uc6a9\ub418\uc9c0 \uc54a\ub294 \ubb38\uc790\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.")}else window.alert("\uc720\uc800 Id\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.")},children:"\ubcf4\ub0b4\uae30"})]})]})};var m=function(){var e,t=Object(n.useState)([]),c=Object(l.a)(t,2),s=c[0],a=c[1],o=Object(n.useState)(null),r=Object(l.a)(o,2),i=r[0],d=r[1];return Object(n.useEffect)((function(){b.collection("rooms").get().then((function(e){var t=[];e.forEach((function(e){var c={id:e.id};t.push(c)})),a(t)}))}),[]),e=i?Object(f.jsx)(O,{selectedRoom:i}):Object(f.jsx)("div",{id:"messages-with-no-selected-room",children:Object(f.jsx)("div",{children:"\ubc29\uc744 \uc120\ud0dd\ud558\uc138\uc694."})}),Object(f.jsxs)("div",{id:"app",children:[Object(f.jsx)("div",{id:"header",children:Object(f.jsx)("h1",{children:"\uac1c\ud1a1"})}),Object(f.jsx)(h,{rooms:s,setRooms:a,selectedRoom:i,setSelectedRoom:d}),e]})},g=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,31)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,o=t.getTTFB;c(e),n(e),s(e),a(e),o(e)}))};o.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(m,{})}),document.getElementById("root")),g()}},[[28,1,2]]]);
//# sourceMappingURL=main.418fa563.chunk.js.map